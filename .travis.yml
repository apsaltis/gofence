language: go
go:
- 1.6
env:
  matrix:
  - GOOS=linux GOARCH=amd64
  - GOOS=linux GOARCH=386
  - GOOS=linux GOARCH=arm
  - GOOS=linux GOARCH=arm64
  - GOOS=linux GOARCH=ppc64
  - GOOS=darwin GOARCH=amd64
  - GOOS=darwin GOARCH=386
  - GOOS=darwin GOARCH=arm
  - GOOS=darwin GOARCH=arm64
  - GOOS=windows GOARCH=amd64
  - GOOS=windows GOARCH=386
  - GOOS=windows GOARCH=arm
  - GOOS=freebsd GOARCH=amd64
  - GOOS=freebsd GOARCH=386
  - GOOS=freebsd GOARCH=arm
install:
- GOOS=`go env GOOS`
- GOARCH=`go env GOARCH`
- printenv
- go generate
script:
- go test -v ./...
- if [[ $TRAVIS_BRANCH == v* ]]; then go build -ldflags '-extldflags "-static"' -o "fence_${GOOS}_${GOARCH}${EXT}"; fi
- ls
deploy:
  provider: releases
  api_key:
    secure: CrvRmjoiEPTWIPWw4BrU1YiZQ9WGkzi7WIOxfCmNnyLcg/a6QVo5CV1vRyTKOY/JEnlU8PusEMgOX81sMIOpyaMHfLpR/ca7UzMp61MzCJ2Yah0Lw7kTJjT+cw5HB12OgxfED51XI9wQjgC+ByaLSH1oS25Md0GbLf0qRHCbLYaNDckw/EgbVNWZTDqUacJJFJcR8tbXYxsUXvBLJda8aPrGjiRaonj6gRjzDMQR2qFeX/kmOOzmIoa17jW9rpqj+G686FvDkyeoeBFFlS8YK8zeViclbpM3gpnpV+HdEixIKRP/gndoH0Tx90DPC64RJj3mibywWffG33RhYKx1twkbJGCU47tRzIapAdzSR4dmUL3rb0W3oJm7GY5IHLcOYWNFWVFRszOIySkM1hXVxbTWwZYZrEFaC9hFDAKB7A4X3D+SAFqseab16XB005RqrUDHAB1uLO03uivRbGWTj7s5I6i+JQfm9ps5UwcVrJm2xWlYFnqjl37rAfZgxXCADYOBjw6PbKF+xJjLvLd4kAEkSQ+siZvKoCBWLNfmmYFZGMWnj0BPFoPot/VDOFKklmTb+FcdyiZ2HFhjojIjkNpHWbNtWwuK0UcEHVm+lCx0K+GqMpz4T7S+dJoDVJBnGmSmiovC37UIwtFnRwnalq6O2Q332ghoFPQyPHzsuls=
  file: fence_${GOOS}_$G{OARCH}${EXT}
  on:
    repo: buckhx/gofence
